name: Nasdaq Market Watch

on:
  schedule:
    # -----------------------------------------------------------
    # UTC 기준 설정 (한국 시간 KST - 9시간)
    # 서버 지연 고려 '50분' 실행 -> 정각 즈음 도착
    # -----------------------------------------------------------

    # 1. 아침 브리핑 (KST 08:50) -> UTC 23:50
    - cron: '50 23 * * *'

    # 2. 점심/주간거래 (KST 11:50) -> UTC 02:50
    - cron: '50 2 * * *'

    # 3. 아시아장 마감 (KST 14:50) -> UTC 05:50
    - cron: '50 5 * * *'

    # 4. 유럽장 개장 (KST 17:50) -> UTC 08:50
    - cron: '50 8 * * *'

    # 5. 프리마켓 중반 (KST 20:50) -> UTC 11:50
    - cron: '50 11 * * *'

    # 6. 미장 개장 직전 (KST 22:50) -> UTC 13:50
    - cron: '50 13 * * *'

    # 7. 미장 초반 (KST 23:50) -> UTC 14:50
    - cron: '50 14 * * *'

    # 8. [추가] 미장 중반 1 (KST 01:50) -> UTC 16:50
    - cron: '50 16 * * *'

    # 9. [추가] 미장 중반 2 (KST 03:50) -> UTC 18:50
    - cron: '50 18 * * *'

    # 10. 장 마감 직전 (KST 05:50) -> UTC 20:50
    - cron: '50 20 * * *'

  workflow_dispatch: # 수동 실행 버튼 유지

jobs:
  run-analysis:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          
      - name: Install Dependencies
        run: |
          pip install -r requirements.txt
          
      - name: Run Alert Bot
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: python main.py
