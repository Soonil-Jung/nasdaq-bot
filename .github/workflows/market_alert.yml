name: Nasdaq Market Watch

on:
  schedule:
    # -----------------------------------------------------------
    # UTC 기준 설정 (한국 시간 KST - 9시간)
    # 깃허브 무료 서버 지연을 고려해 '50분'에 실행 -> '정각' 쯤 도착
    # -----------------------------------------------------------

    # 1. 아침 브리핑 (KST 08:50) -> UTC 23:50 (전날)
    - cron: '50 23 * * *'

    # 2. [추가] 점심/주간거래 (KST 11:50) -> UTC 02:50
    - cron: '50 2 * * 1-5'

    # 3. [추가] 아시아장 마감 (KST 14:50) -> UTC 05:50
    - cron: '50 5 * * 1-5'

    # 4. 유럽장 개장/프리마켓 (KST 17:50) -> UTC 08:50
    - cron: '50 8 * * 1-5'

    # 5. [추가] 프리마켓 중반 (KST 20:50) -> UTC 11:50
    - cron: '50 11 * * 1-5'

    # 6. 미장 시작 전 (KST 22:50) -> UTC 13:50
    - cron: '50 13 * * 1-5'

    # 7. 장 마감 직전 (KST 05:50) -> UTC 20:50
    - cron: '50 20 * * 1-5'

  workflow_dispatch: # 수동 실행 버튼 유지

jobs:
  run-analysis:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          
      - name: Install Dependencies
        run: |
          pip install -r requirements.txt
          
      - name: Run Alert Bot
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: python main.py
