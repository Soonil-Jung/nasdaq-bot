name: Nasdaq Market Watch

on:
  schedule:
    # -----------------------------------------------------------
    # UTC 기준 설정 (한국 시간 KST - 9시간)
    # 서버 지연 고려 '50분' 실행 -> 정각(00분) 즈음 도착
    # -----------------------------------------------------------

    # [오전 ~ 오후]
    - cron: '50 22 * * *'  # KST 08:00 (아침)
    - cron: '50 0 * * *'   # KST 10:00
    - cron: '50 2 * * *'   # KST 12:00
    - cron: '50 4 * * *'   # KST 14:00
    - cron: '50 6 * * *'   # KST 16:00

    # [저녁 ~ 밤]
    - cron: '50 8 * * *'   # KST 18:00
    - cron: '50 10 * * *'  # KST 20:00
    - cron: '50 12 * * *'  # KST 22:00
    - cron: '50 13 * * *'  # KST 23:00

    # [자정 ~ 새벽]
    - cron: '50 14 * * *'  # KST 24:00 (00:00)
    - cron: '50 16 * * *'  # KST 02:00
    - cron: '50 18 * * *'  # KST 04:00
    - cron: '50 20 * * *'  # KST 06:00

  workflow_dispatch: # 수동 실행 버튼 유지

jobs:
  run-analysis:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          
      - name: Install Dependencies
        run: |
          pip install -r requirements.txt
          
      - name: Run Alert Bot
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: python main.py
